<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lịch Chiếu Phim - CiBYHD</title>
    <!-- CSS -->
    <link rel="stylesheet" href="/frontend/assets/css/shares/header.css">
    <link rel="stylesheet" href="/frontend/assets/css/shares/admin.css">
    <link rel="stylesheet" href="/frontend/assets/css/shares/footer.css">
    <link rel="stylesheet" href="/frontend/assets/css/style.css">
    <link rel="stylesheet" href="/frontend/assets/css/login.css">
    <link rel="stylesheet" href="/frontend/assets/css/schedule.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body data-page="show-schedule">
    <!-- Placeholder cho header -->
    <div id="header-placeholder"></div>

    <!-- Placeholder cho sidebar -->
    <div id="sidebar-placeholder"></div>

    <!-- Nội dung chính -->
    <main class="main-content">
        <div class="movies-container">
            <div class="page-header">
                <h1><i class="fas fa-calendar-alt"></i> Lịch Chiếu Phim</h1>
                <button class="add-movie-btn" onclick="window.location.href='/frontend/pages/movie/'">
                    <i class="fas fa-plus-circle"></i> Thêm Lịch Chiếu
                </button>
            </div>
            <nav class="breadcrumb">
                <a href="/frontend/pages/index.html">Trang Chủ</a> /
                <span>Lịch Chiếu Phim</span>
            </nav>

            <section class="movie-categories">
                <div class="category-tabs">
                    <button class="category-tab active">
                        <i class="fas fa-clock"></i> Lịch Chiếu
                    </button>
                </div>
                <form class="schedule-form">
                    <div class="form-group">
                        <label for="schedule-date">1. Ngày <i class="fa-solid fa-calendar-days"></i></label>
                        <select id="schedule-date" name="date">
                            <option value="2024-04-22">Hôm nay 22/04</option>
                            <option value="2024-04-23">Thứ 4 23/04</option>
                            <option value="2024-04-24">Thứ 5 24/04</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="schedule-film">2. Phim <i class="fa-solid fa-film"></i></label>
                        <select id="schedule-film" name="film">
                            <option value="">Chọn Phim</option>
                            <option value="1">Phim A</option>
                            <option value="2">Phim B</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="schedule-cinema">3. Rạp <i class="fa-solid fa-location-dot"></i></label>
                        <select id="schedule-cinema" name="cinema">
                            <option value="">Chọn rạp</option>
                            <option value="1">Rạp 1</option>
                            <option value="2">Rạp 2</option>
                        </select>
                    </div>
                </form>

                <!-- Phần hiển thị kết quả lịch chiếu -->
                <div id="schedule-results" class="schedule-results" style="margin-top: 20px; color: #fff;">
                    <h2>Kết Quả Lịch Chiếu</h2>
                    <div id="schedule-list"></div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer id="footer-container"></footer>

    <!-- Scripts -->
    <script src="https://kit.fontawesome.com/08325f215d.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="/frontend/assets/js/main.js"></script>
    <script src="/frontend/assets/js/admin.js"></script>
    <script src="/frontend/assets/js/movie.js"></script>
    <script>
        // Dữ liệu phim và rạp
        const films = [
            { id: 1, name: 'TÌM XÁC: MA KHÔNG ĐẦU (T18)', duration: '119 phút', ageLimit: '18+', description: 'Đây là mô tả của Phim A.', poster: '/frontend/assets/images/tim-xac_1.webp' },
            { id: 2, name: 'Phim B', duration: '135 phút', ageLimit: '18+', description: 'Đây là mô tả của Phim B.', poster: 'https://via.placeholder.com/200x300?text=Phim+B' }
        ];
        const cinemas = [
            { id: 1, name: 'Rạp 1' },
            { id: 2, name: 'Rạp 2' }
        ];

        // Dữ liệu lịch chiếu (cập nhật suất chiếu từ hình ảnh)
        const schedules = [
            { date: '2024-04-22', filmId: 1, cinemaId: 1, showtimes: ['15:00', '16:15', '18:00', '19:40', '21:25'] },
            { date: '2024-04-22', filmId: 2, cinemaId: 1, showtimes: ['15:40', '17:20', '19:00', '20:20', '22:00'] },
            { date: '2024-04-22', filmId: 1, cinemaId: 2, showtimes: ['18:30', '20:50', '22:40', '23:50'] },
            { date: '2024-04-23', filmId: 2, cinemaId: 2, showtimes: ['15:00', '17:20', '19:40', '22:40'] },
            { date: '2024-04-24', filmId: 1, cinemaId: 1, showtimes: ['16:15', '18:00', '20:20', '23:10'] },
        ];

        // Hàm hiển thị lịch chiếu cho một lịch cụ thể
        function displaySingleSchedule(schedule) {
            const scheduleList = document.getElementById('schedule-list');
            const film = films.find(f => f.id == schedule.filmId);
            const cinema = cinemas.find(c => c.id == schedule.cinemaId);

            // Tạo layout chia đôi
            const container = document.createElement('div');
            container.style.display = 'flex';
            container.style.gap = '20px';
            container.style.alignItems = 'flex-start';
            container.style.marginBottom = '30px';

            // Bên trái: Poster và thông tin phim
            const leftSection = document.createElement('div');
            leftSection.style.flex = '1';
            leftSection.style.display = 'flex';
            leftSection.style.flexDirection = 'column';
            leftSection.style.alignItems = 'flex-start';

            // Poster
            const poster = document.createElement('img');
            poster.src = film.poster;
            poster.alt = film.name;
            poster.style.width = 'auto';
            poster.style.height = '500px';
            poster.style.borderRadius = '8px';
            poster.style.marginBottom = '15px';
            leftSection.appendChild(poster);

            // Thông tin phim
            const filmInfo = document.createElement('div');
            filmInfo.innerHTML = `
                <h3 style="margin: 0; font-size: 18px; color: #ff6200;">${film.name}</h3>
                <p style="margin: 5px 0;"><strong>Thời lượng:</strong> ${film.duration}</p>
                <p style="margin: 5px 0;"><strong>Giới hạn độ tuổi:</strong> ${film.ageLimit}</p>
                <p style="margin: 5px 0;"><strong>Mô tả:</strong> ${film.description}</p>
                <p style="margin: 5px 0;"><strong>Ngày chiếu:</strong> ${schedule.date}</p>
                <p style="margin: 5px 0;"><strong>Rạp:</strong> ${cinema.name}</p>
            `;
            leftSection.appendChild(filmInfo);

            // Bên phải: Danh sách suất chiếu
            const rightSection = document.createElement('div');
            rightSection.style.flex = '1';
            rightSection.style.display = 'flex';
            rightSection.style.flexDirection = 'column';

            const showtimesTitle = document.createElement('h3');
            showtimesTitle.textContent = 'Suất chiếu';
            showtimesTitle.style.margin = '0 0 15px 0';
            showtimesTitle.style.fontSize = '18px';
            showtimesTitle.style.color = '#ff6200';
            rightSection.appendChild(showtimesTitle);

            // Sử dụng grid để hiển thị suất chiếu
            const showtimesGrid = document.createElement('div');
            showtimesGrid.style.display = 'grid';
            showtimesGrid.style.gridTemplateColumns = 'repeat(auto-fill, minmax(80px, 1fr))';
            showtimesGrid.style.gap = '10px';

            schedule.showtimes.forEach(showtime => {
                const timeBox = document.createElement('div');
                timeBox.textContent = showtime;
                timeBox.style.padding = '10px';
                timeBox.style.border = '1px solid #fff';
                timeBox.style.borderRadius = '5px';
                timeBox.style.textAlign = 'center';
                timeBox.style.color = '#fff';
                timeBox.style.backgroundColor = 'transparent';
                timeBox.style.cursor = 'pointer';
                timeBox.style.transition = 'background-color 0.3s ease';
                timeBox.onmouseover = () => timeBox.style.backgroundColor = '#ff6200';
                timeBox.onmouseout = () => timeBox.style.backgroundColor = 'transparent';
                timeBox.onclick = () => alert(`Bạn đã chọn suất chiếu ${showtime} cho ${film.name} tại ${cinema.name} vào ngày ${schedule.date}!`);
                showtimesGrid.appendChild(timeBox);
            });
            rightSection.appendChild(showtimesGrid);

            // Gộp hai phần vào container
            container.appendChild(leftSection);
            container.appendChild(rightSection);
            scheduleList.appendChild(container);
        }

        // Hàm hiển thị tất cả lịch chiếu của một ngày
        function displaySchedulesForDate(date) {
            const scheduleList = document.getElementById('schedule-list');
            scheduleList.innerHTML = ''; // Xóa nội dung cũ

            // Lọc tất cả lịch chiếu của ngày được chọn
            const dateSchedules = schedules.filter(schedule => schedule.date === date);

            if (dateSchedules.length === 0) {
                scheduleList.innerHTML = '<p>Không có lịch chiếu nào cho ngày này.</p>';
                return;
            }

            // Hiển thị từng lịch chiếu
            dateSchedules.forEach(schedule => {
                displaySingleSchedule(schedule);
            });
        }

        // Hàm hiển thị lịch chiếu khi chọn ngày, phim và rạp
        function displayScheduleResults(date, filmId, cinemaId) {
            const scheduleList = document.getElementById('schedule-list');
            scheduleList.innerHTML = ''; // Xóa nội dung cũ

            // Lọc lịch chiếu theo ngày, phim và rạp
            const filteredSchedules = schedules.filter(schedule =>
                schedule.date === date && schedule.filmId == filmId && schedule.cinemaId == cinemaId
            );

            if (filteredSchedules.length === 0) {
                scheduleList.innerHTML = '<p>Không có lịch chiếu nào phù hợp.</p>';
                return;
            }

            // Hiển thị lịch chiếu
            filteredSchedules.forEach(schedule => {
                displaySingleSchedule(schedule);
            });
        }

        // Hiển thị lịch chiếu mặc định khi trang được tải
        document.addEventListener('DOMContentLoaded', function() {
            const dateSelect = document.getElementById('schedule-date');
            const defaultDate = dateSelect.value; // Lấy giá trị mặc định của dropdown ngày
            if (defaultDate === '2024-04-22') {
                displaySchedulesForDate('2024-04-22'); // Hiển thị lịch chiếu cho ngày "Hôm nay"
            }
        });

        // Xử lý sự kiện thay đổi trên các dropdown
        const dateSelect = document.getElementById('schedule-date');
        const filmSelect = document.getElementById('schedule-film');
        const cinemaSelect = document.getElementById('schedule-cinema');

        dateSelect.addEventListener('change', updateScheduleResults);
        filmSelect.addEventListener('change', updateScheduleResults);
        cinemaSelect.addEventListener('change', updateScheduleResults);

        function updateScheduleResults() {
            const date = dateSelect.value;
            const filmId = filmSelect.value;
            const cinemaId = cinemaSelect.value;

            // Nếu chỉ chọn ngày (hoặc ngày là "Hôm nay"), hiển thị tất cả lịch chiếu của ngày đó
            if (date && !filmId && !cinemaId) {
                displaySchedulesForDate(date);
            }
            // Nếu chọn cả ngày, phim và rạp, hiển thị lịch chiếu phù hợp
            else if (date && filmId && cinemaId) {
                displayScheduleResults(date, filmId, cinemaId);
            } else {
                // Nếu không chọn đủ, hiển thị tất cả lịch chiếu của ngày được chọn
                if (date) {
                    displaySchedulesForDate(date);
                } else {
                    document.getElementById('schedule-list').innerHTML = ''; // Xóa kết quả nếu chưa chọn ngày
                }
            }
        }

        // Bỏ logic submit form không cần thiết
        document.querySelector('.schedule-form').addEventListener('submit', function(event) {
            event.preventDefault();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'934315bd1f021d6c',t:'MTc0NTMwMzU1Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9343869858a41d74',t:'MTc0NTMwODE3OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9343bd29b91c1399',t:'MTc0NTMxMDQxNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
</body>
</html>