<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- CSS -->
    <link rel="stylesheet" href="../assets/css/movielist/editfilm.css">
    <title>Chỉnh sửa phim</title>
</head>
<body>
    <h1>Chỉnh sửa phim</h1>
    <a href="listfilm.html">Quay lại danh sách phim</a>
    <div class="film-details">
        <img id="film-poster" src="" alt="Poster phim">
        <form id="edit-film-form">
            <label for="film-name">Tên phim:</label>
            <input type="text" id="film-name" name="name" required>

            <label for="film-duration">Thời lượng:</label>
            <input type="text" id="film-duration" name="duration" required>

            <label for="film-description">Mô tả:</label>
            <textarea id="film-description" name="description" rows="5" required></textarea>

            <label for="film-poster-url">URL Poster:</label>
            <input type="text" id="film-poster-url" name="poster">

            <button type="submit">Lưu</button>
        </form>
    </div>

    <!-- Jss của sửa phim -->
    <script>
        // Lấy ID phim từ URL
        const urlParams = new URLSearchParams(window.location.search);
        const filmId = urlParams.get('id');

        // Tải thông tin phim từ localStorage
        document.addEventListener('DOMContentLoaded', function() {
            const films = JSON.parse(localStorage.getItem('films')) || [];
            const film = films.find(f => f.id == filmId);
            if (film) {
                document.getElementById('film-poster').src = film.poster;
                document.getElementById('film-name').value = film.name;
                document.getElementById('film-duration').value = film.duration;
                document.getElementById('film-description').value = film.description;
                document.getElementById('film-poster-url').value = film.poster;
            } else {
                alert('Không tìm thấy phim!');
                window.location.href = 'listfilm.html';
            }
        });

        // Xử lý submit form để cập nhật thông tin phim
        document.getElementById('edit-film-form').addEventListener('submit', function(event) {
            event.preventDefault();
            let films = JSON.parse(localStorage.getItem('films')) || [];
            const filmIndex = films.findIndex(f => f.id == filmId);
            if (filmIndex !== -1) {
                films[filmIndex] = {
                    id: parseInt(filmId),
                    name: document.getElementById('film-name').value,
                    duration: document.getElementById('film-duration').value,
                    description: document.getElementById('film-description').value,
                    poster: document.getElementById('film-poster-url').value || films[filmIndex].poster
                };
                localStorage.setItem('films', JSON.stringify(films));
                alert('Cập nhật phim thành công!');
                window.location.href = 'listfilm.html';
            }
        });
    </script>
</body>
</html>